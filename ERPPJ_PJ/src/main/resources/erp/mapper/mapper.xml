<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace = "com.pj.erp.persistence.ERPDAO">
	<select id="loginCheck" resultType = "java.util.Map" parameterType = "String">
		select *
		from userauth
		where username = #{username}
	</select>
	
	<select id="authCheck" resultType = "java.util.Map" parameterType = "String">
		SELECT username, authority
		FROM authority
		WHERE username = #{username}	
	</select>
	
	<!-- nfc 등록 -->
	<insert id="nfc" parameterType="String">
		insert into nfc_log_tbl(nfc_code, tag_code)
		values(#{nfcid}, lpad(NFC_CODE_SEQ.nextval,8,'NFC_'))
	</insert>
	
	<!-- NFC로 출퇴근 사람 username가져오기 -->
	<select id="selectNfc" parameterType="String" resultType="com.pj.erp.vo.HR.HR_nfc_log">
		Select nfc_code, Min(tag_date) as min, Max(tag_date) as max, e_name, username 
		From nfc_daylog_view
        Where nfc_code = #{nfc_code}
        And tag_date like to_char(sysdate, 'yyyymmdd%')
		Group by e_name, username, nfc_code
	</select>
	
	<!-- 블록체인을 위한 department_group_Code select -->
	<select id="getGroupCode" parameterType="String" resultType="com.pj.erp.vo.BlockChainVO">
		Select e.ether_code as ether_code, e.department_code as department_code  
		    , e.wallet_code as wallet_code, d.department_name as department_name
		From ether_tbl e Join department_tbl d
		On e.department_code = d.department_code
		Where e.department_code = #{department_code} 
	</select>
	

</mapper>