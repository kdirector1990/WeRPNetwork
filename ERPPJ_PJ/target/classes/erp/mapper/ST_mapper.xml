<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
 <mapper namespace = "com.pj.erp.persistence.ST_DAO">
 	
 	<select id = "getSaleCnt" resultType="int">
 		SELECT COUNT(*) as FROM saleplan_tbl
 	</select>
 	
 	<select id="getsaleplan" resultType="com.pj.erp.vo.ST.SalePlan" parameterType="java.util.Map">
 		select * from saleplan_tbl
 	</select>
 	
 	<select id="getSaleplanArticle" resultType="com.pj.erp.vo.ST.SalePlan">
 		SELECT * FROM saleplan_tbl WHERE saleplan_code=#{saleplan_code}
 	</select>
 	
 	<update id="updatesalePlan" parameterType="com.pj.erp.vo.ST.SalePlan">
 		UPDATE saleplan_tbl SET ef_price=#{ef_price}, s_plan_start =#{s_plan_start}, s_plan_end=#{s_plan_end}, ef_amount=#{ef_amount}, sp_unit=#{sp_unit}, sp_note=#{sp_note} WHERE saleplan_code=#{saleplan_code}
 	</update>
 	
 	<delete id="deletesalePlan" parameterType="String">
 		DELETE saleplan_tbl WHERE saleplan_code=#{saleplan_code}
 	</delete>
 	
 	
 	<!-- estimate_price 견적 현황 -->
 	<insert id="estimatewritePro" parameterType="com.pj.erp.vo.ST.Estimate">
 		INSERT INTO estimate_price_tbl(ep_code, ep_amount, ep_deliver_date, ep_price, ep_reg_date)
 			VALUES(#{ep_code}, #{ep_amount}, #{ep_deliver_date}, #{ep_price}, sysdate)
 	</insert>
 	
 	<select id="getestimateCnt" resultType="int">
 		select COUNT(*) as FROM estimate_price_tbl
 	</select>
 	
 	<select id="getestimate" resultType="com.pj.erp.vo.ST.Estimate" parameterType="java.util.Map">
 		SELECT * FROM estimate_price_tbl
 	</select>
 	
 	<select id="getEstimateArticle" resultType="com.pj.erp.vo.ST.Estimate">
 		SELECT * FROM estimate_price_tbl WHERE ep_code=#{ep_code}
 	</select>
 	
 	<update id="updateEstimate" parameterType="com.pj.erp.vo.ST.Estimate">
 		UPDATE estimate_price_tbl SET ep_amount=#{ep_amount}, ep_deliver_date=#{ep_deliver_date}, ep_reg_date=sysdate WHERE ep_code=#{ep_code}
 	</update>
 	
 	<delete id="deleteEstimate" parameterType="String">
 		DELETE estimate_price_tbl WHERE ep_code =#{ep_code}
 	</delete>
	
	<!-- release (출고) --> 
 	<select id="getReleaseCnt" resultType="int">
 		select COUNT(*) as FROM sar_list_tbl
 	</select>
 	
 	<select id="getReleaseList" resultType="com.pj.erp.vo.ST.Release" parameterType="java.util.Map">
 		SELECT * FROM sar_list_tbl
 	</select>
 	
 	<select id="getReleaseArticle" resultType="com.pj.erp.vo.ST.Release">
 		SELECT * FROM sar_list_tbl WHERE sar_code=#{sar_code}
 	</select>
 	
 	<update id="updateRelease" parameterType="com.pj.erp.vo.ST.Release">
 	 	UPDATE sar_list_tbl SET release_name=#{release_name}, release_count=#{release_count}, unit_cost=#{unit_cost}, stored_name=${stored_name}, stored_count=#{stored_count}, sar_type=#{sar_type} WHERE sar_code=#{sar_code}
 	</update>
 	
 	<delete id="deleteRelease" parameterType="String">
 		DELETE sar_list_tbl WHERE sar_code=#{sar_code}
 	</delete>
 	
 	<insert id="insertRelease" parameterType="com.pj.erp.vo.ST.Release">
 		INSERT INTO sar_list_tbl(release_name, stored_name, unit_cost, release_count, stored_count, sar_code, release_date, detail_ac_code, sar_type, username)
 			VALUES(#{release_name}, #{stored_name}, #{unit_cost},#{release_count}, #{stored_count}, #{sar_code}, sysdate, 'qa8', #{sar_type}, #{username})
 	</insert>
 	
 	<!-- saleList -->
 	<insert id="insertsaleList" parameterType="com.pj.erp.vo.ST.SaleList">
 		INSERT INTO salelist_tbl(salelist_code, username, reg_date, release_o_date, unit, amount, price, note)
 			VALUES(salelist_seq.nextval, #{username}, sysdate, #{release_o_date}, #{unit}, #{amount}, #{price}, #{note})
 	</insert>
 	
 	<select id="getSaleListCnt" resultType="int">
 		SELECT COUNT(*) as FROM salelist_tbl
 	</select>
 	
 	<select id="getSaleListArticle" resultType="com.pj.erp.vo.ST.SaleList" parameterType="java.util.Map">
 		SELECT * FROM salelist_tbl
 	</select>
 	
 	<select id="getsaleListForm" resultType="com.pj.erp.vo.ST.SaleList">
 		SELECT * FROM salelist_tbl WHERE salelist_code = #{salelist_code}
 	</select>
 	
 	<update id="updateSaleList" parameterType="com.pj.erp.vo.ST.SaleList">
 		UPDATE salelist_tbl SET release_o_date=#{release_o_date}, unit=#{unit}, price=#{price}, note=#{note} WHERE salelist_code=#{salelist_code}
 	</update>
 	
 	
 	<!-- Product 검색 -->
	<select id="selectProduct" resultType="int" parameterType="String" >
		select COUNT(*) from product_list_tbl where product_name like '%'||#{product_name}||'%'
	</select>
	
	<!-- 검색 목록 가져오기 -->
	<select id="getProductList" resultType="com.pj.erp.vo.ST.ProductList" parameterType="String">
		select product_code, bom_code, product_name from product_list_tbl where product_name like '%'||#{product_name}||'%'
	</select> 	
	
	<!-- Customer 검색 -->
	<select id="selectCustomer" resultType="int" parameterType="String">
		SELECT COUNT(*) FROM customer_list_tbl WHERE customer_name like '%'||#{customer_name}||'%'
	</select>
	
	<!-- 검색 목록 가져오기 -->
	<select id="getCustomerList" resultType="com.pj.erp.vo.ST.CustomerList" parameterType="String">
		select customer_code, license_number, customer_name, branch_name, customer_credit, deal_state from customer_list_tbl where customer_name like '%'||#{customer_name}||'%'
	</select>
 </mapper>